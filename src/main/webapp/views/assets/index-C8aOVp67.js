import{f as G,d as H,u as O,c as J}from"./product-C__u8Dff.js";import{f as K}from"./category-0uh354pA.js";import{u as w}from"./index-7XaKpovQ.js";import{l as Q}from"./lodash-BNYBvJY_.js";import{d as W,r as b,a as X,o as Y,c as y,w as Z,u as e,b as l,e as t,i as ee,F as h,G as le,f as ae,g as c,E as s,h as V,q as U,C as q,j as i,k as u,l as B,m as d,n as F,t as $,p as te,H as oe,v as re,x as ne,y as de,z as k,D as A,s as N}from"./index-CTdGs5XT.js";const ue={slot:"footer",class:"text-right"},ge=W({__name:"index",setup(se){const D=b([]),{bool:_,toggle:p}=w(),m=X({}),f=()=>{G(m).then(n=>{D.value=n.list||[]})},I=n=>{var o;r.value=Q.cloneDeep(n),v(),(o=E.value)==null||o.resetFields()},R=n=>{de.confirm("确定删除吗？","提示",{type:"warning"}).then(()=>{p(),H(n).then(()=>{k.success("删除成功~"),f()}).finally(()=>p())}).catch(()=>{k.info("取消操作~")})},{bool:C,toggle:v}=w(),r=b({}),E=b(),T=()=>{var n;(n=E.value)==null||n.validate(o=>{o&&(r.value.id?M(r.value):P(r.value))})},M=n=>{p(),O(n).then(()=>{k.success("更新成功~"),v(),f()}).finally(()=>p())},P=n=>{p(),J(n).then(()=>{k.success("创建成功~"),v(),f()}).finally(()=>p())},x=b([]),L=()=>{K().then(n=>{x.value=n.list||[]})},S=le(),j=n=>{S.push({name:"productDetail",params:{id:n.id}})};return Y(()=>{f(),L()}),(n,o)=>{const z=ae("loading");return c(),y(h,null,[Z((c(),y("div",null,[l(e(B),{inline:""},{default:t(()=>[l(e(s),{prop:"name"},{default:t(()=>[l(e(V),{modelValue:m.name,"onUpdate:modelValue":o[0]||(o[0]=a=>m.name=a),placeholder:"商品名",clearable:""},null,8,["modelValue"])]),_:1}),l(e(s),{prop:"categoryId"},{default:t(()=>[l(e(U),{modelValue:m.categoryId,"onUpdate:modelValue":o[1]||(o[1]=a=>m.categoryId=a),placeholder:"商品分类",clearable:"",style:{width:"120px"}},{default:t(()=>[(c(!0),y(h,null,q(x.value,a=>(c(),A(e(N),{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(e(s),null,{default:t(()=>[l(e(i),{type:"primary",onClick:f},{default:t(()=>[u("查询")]),_:1}),l(e(i),{type:"success",onClick:o[2]||(o[2]=a=>I({price:1}))},{default:t(()=>[u("新增")]),_:1})]),_:1})]),_:1}),l(e(te),{data:D.value,border:""},{default:t(()=>[l(e(d),{prop:"name",label:"商品名称",align:"center"}),l(e(d),{prop:"code",label:"商品标识",align:"center"}),l(e(d),{prop:"price",label:"商品单价",align:"center"},{default:t(({row:a})=>[l(e(F),{type:"danger"},{default:t(()=>[u("￥"+$(a.price),1)]),_:2},1024)]),_:1}),l(e(d),{prop:"description",label:"描述",align:"center"}),l(e(d),{prop:"categoryId",label:"所属类别",align:"center"},{default:t(({row:a})=>[l(e(F),{type:"primary"},{default:t(()=>{var g;return[u($((g=a.category)==null?void 0:g.name),1)]}),_:2},1024)]),_:1}),l(e(d),{prop:"sellCount",label:"商品销量",align:"center"}),l(e(d),{prop:"score",label:"评分",align:"center"}),l(e(d),{prop:"createdAt",label:"创建时间",align:"center"}),l(e(d),{prop:"updatedAt",label:"更新时间",align:"center"}),l(e(d),{prop:"action",label:"操作",align:"center","min-width":"120px"},{default:t(({row:a})=>[l(e(i),{type:"success",link:"",onClick:g=>j(a)},{default:t(()=>[u("详情")]),_:2},1032,["onClick"]),l(e(i),{type:"primary",link:"",onClick:g=>I(a)},{default:t(()=>[u("编辑")]),_:2},1032,["onClick"]),l(e(i),{type:"danger",link:"",onClick:g=>R(a.id)},{default:t(()=>[u("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])])),[[z,e(_)]]),l(e(ne),{modelValue:e(C),"onUpdate:modelValue":o[8]||(o[8]=a=>ee(C)?C.value=a:null),title:r.value.id?"编辑商品":"添加商品",width:"30%"},{default:t(()=>[l(e(B),{ref_key:"formRef",ref:E,model:r.value,"label-position":"top"},{default:t(()=>[l(e(s),{prop:"name",label:"商品名",rules:[{required:!0,message:"请输入商品名"}]},{default:t(()=>[l(e(V),{modelValue:r.value.name,"onUpdate:modelValue":o[3]||(o[3]=a=>r.value.name=a),disabled:!!r.value.id,placeholder:"请输入商品名"},null,8,["modelValue","disabled"])]),_:1}),l(e(s),{prop:"code",label:"商品标识",rules:[{required:!0,message:"请输入商品标识"}]},{default:t(()=>[l(e(V),{modelValue:r.value.code,"onUpdate:modelValue":o[4]||(o[4]=a=>r.value.code=a),disabled:!!r.value.id,placeholder:"请输入商品标识"},null,8,["modelValue","disabled"])]),_:1}),l(e(s),{prop:"price",label:"商品单价",rules:[{required:!0,type:"number",message:"请输入商品单价"}]},{default:t(()=>[l(e(oe),{modelValue:r.value.price,"onUpdate:modelValue":o[5]||(o[5]=a=>r.value.price=a),min:.01,max:999999,step:.01},null,8,["modelValue"])]),_:1}),l(e(s),{prop:"description",label:"描述",rules:[{required:!0,message:"请输入描述"}]},{default:t(()=>[l(e(V),{modelValue:r.value.description,"onUpdate:modelValue":o[6]||(o[6]=a=>r.value.description=a),placeholder:"请输入描述",type:"textarea",rows:3,maxlength:255,"show-word-limit":""},null,8,["modelValue"])]),_:1}),l(e(s),{prop:"categoryId",label:"所属类别",rules:[{required:!0,type:"number",message:"请选择所属类别"}]},{default:t(()=>[l(e(U),{modelValue:r.value.categoryId,"onUpdate:modelValue":o[7]||(o[7]=a=>r.value.categoryId=a),placeholder:"请选择所属类别"},{default:t(()=>[(c(!0),y(h,null,q(x.value,a=>(c(),A(e(N),{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),re("div",ue,[l(e(i),{loading:e(_),onClick:e(v)},{default:t(()=>[u("取 消")]),_:1},8,["loading","onClick"]),l(e(i),{loading:e(_),type:"primary",onClick:T},{default:t(()=>[u("确 定")]),_:1},8,["loading"])])]),_:1},8,["modelValue","title"])],64)}}});export{ge as default};
