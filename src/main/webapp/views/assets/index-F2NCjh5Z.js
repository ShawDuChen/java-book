import{f as L,d as S,u as j,c as z}from"./category-DMuWif5j.js";import{u as h}from"./index-BJJCNVtC.js";import{l as G}from"./lodash-DseUsP9g.js";import{d as O,a as k,b as H,B as I,o as J,c as E,w as K,u as e,e as l,f as o,i as P,F as B,C as Q,g as W,h as g,E as i,j as v,k as p,l as s,m as D,n as r,t as X,q as Y,s as Z,v as q,D as ee,x as le,y as ae,z as te,A as b,G as oe}from"./index-a7oZ5LST.js";const ne={slot:"footer",class:"text-right"},pe=O({__name:"index",setup(de){const c=k([]),{bool:y,toggle:u}=h(),V=H({}),m=()=>{L(V.name).then(n=>{c.value=n.list||[]})},w=I(()=>c.value.filter(n=>n.parentId===0)),F=I(()=>c.value.reduce((n,t)=>(n[`${t.id}`]=t.name,n),{})),x=n=>{var t;d.value=G.cloneDeep(n),f(),(t=C.value)==null||t.resetFields()},U=n=>{te.confirm("确定删除吗？","提示",{type:"warning"}).then(()=>{u(),S(n).then(()=>{b.success("删除成功~"),m()}).finally(()=>u())}).catch(()=>{b.info("取消操作~")})},{bool:_,toggle:f}=h(),d=k({}),C=k(),A=()=>{var n;(n=C.value)==null||n.validate(t=>{t&&(d.value.id?M(d.value):$(d.value))})},M=n=>{u(),j(n).then(()=>{b.success("更新成功~"),f(),m()}).finally(()=>u())},$=n=>{u(),z(n).then(()=>{b.success("创建成功~"),f(),m()}).finally(()=>u())};return J(()=>{m()}),(n,t)=>{const N=Q("el-tag"),R=W("loading");return g(),E(B,null,[K((g(),E("div",null,[l(e(D),{inline:""},{default:o(()=>[l(e(i),{prop:"name"},{default:o(()=>[l(e(v),{modelValue:V.name,"onUpdate:modelValue":t[0]||(t[0]=a=>V.name=a),placeholder:"类别名",clearable:""},null,8,["modelValue"])]),_:1}),l(e(i),null,{default:o(()=>[l(e(p),{type:"primary",onClick:m},{default:o(()=>[s("查询")]),_:1}),l(e(p),{type:"success",onClick:t[1]||(t[1]=a=>x({}))},{default:o(()=>[s("新增")]),_:1})]),_:1})]),_:1}),l(e(Y),{data:c.value,border:""},{default:o(()=>[l(e(r),{prop:"name",label:"类别名称",align:"center"}),l(e(r),{prop:"code",label:"类别标识",align:"center"}),l(e(r),{prop:"description",label:"描述",align:"center"}),l(e(r),{prop:"parentId",label:"所属类别",align:"center"},{default:o(({row:a})=>[l(N,{type:a.parentId===0?"success":"primary"},{default:o(()=>[s(X(a.parentId===0?"一级类别":F.value[a.parentId]),1)]),_:2},1032,["type"])]),_:1}),l(e(r),{prop:"createdAt",label:"创建时间",align:"center"}),l(e(r),{prop:"updatedAt",label:"更新时间",align:"center"}),l(e(r),{prop:"action",label:"操作",align:"center","min-width":"120px"},{default:o(({row:a})=>[l(e(p),{type:"primary",link:"",onClick:T=>x(a)},{default:o(()=>[s("编辑")]),_:2},1032,["onClick"]),l(e(p),{type:"danger",link:"",onClick:T=>U(a.id)},{default:o(()=>[s("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])])),[[R,e(y)]]),l(e(ae),{modelValue:e(_),"onUpdate:modelValue":t[6]||(t[6]=a=>P(_)?_.value=a:null),title:d.value.id?"编辑类别":"添加类别",width:"30%"},{default:o(()=>[l(e(D),{ref_key:"formRef",ref:C,model:d.value,"label-position":"top"},{default:o(()=>[l(e(i),{prop:"name",label:"类别名",rules:[{required:!0,message:"请输入类别名"}]},{default:o(()=>[l(e(v),{modelValue:d.value.name,"onUpdate:modelValue":t[2]||(t[2]=a=>d.value.name=a),disabled:!!d.value.id,placeholder:"请输入类别名"},null,8,["modelValue","disabled"])]),_:1}),l(e(i),{prop:"code",label:"类别标识",rules:[{required:!0,message:"请输入类别标识"}]},{default:o(()=>[l(e(v),{modelValue:d.value.code,"onUpdate:modelValue":t[3]||(t[3]=a=>d.value.code=a),disabled:!!d.value.id,placeholder:"请输入类别标识"},null,8,["modelValue","disabled"])]),_:1}),l(e(i),{prop:"description",label:"描述",rules:[{required:!0,message:"请输入描述"}]},{default:o(()=>[l(e(v),{modelValue:d.value.description,"onUpdate:modelValue":t[4]||(t[4]=a=>d.value.description=a),placeholder:"请输入描述",type:"textarea",rows:3,maxlength:255,"show-word-limit":""},null,8,["modelValue"])]),_:1}),l(e(i),{prop:"parentId",label:"所属类别",rules:[{required:!0,type:"number",message:"请选择所属类别"}]},{default:o(()=>[l(e(Z),{modelValue:d.value.parentId,"onUpdate:modelValue":t[5]||(t[5]=a=>d.value.parentId=a),placeholder:"请选择所属类别"},{default:o(()=>[l(e(q),{label:"一级类别",value:0}),(g(!0),E(B,null,ee(w.value,a=>(g(),oe(e(q),{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),le("div",ne,[l(e(p),{loading:e(y),onClick:e(f)},{default:o(()=>[s("取 消")]),_:1},8,["loading","onClick"]),l(e(p),{loading:e(y),type:"primary",onClick:A},{default:o(()=>[s("确 定")]),_:1},8,["loading"])])]),_:1},8,["modelValue","title"])],64)}}});export{pe as default};
