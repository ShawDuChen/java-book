import{f as j,d as z,u as G,c as H}from"./product-CeFBVt4O.js";import{f as O}from"./category-DMuWif5j.js";import{u as D}from"./index-BJJCNVtC.js";import{l as J}from"./lodash-DseUsP9g.js";import{d as K,a as b,b as Q,o as W,c as y,w as X,u as e,e as l,f as t,i as Y,F as h,g as Z,h as p,E as u,j as V,s as U,D as q,k as m,l as s,m as B,n,p as F,t as A,q as ee,H as le,x as ae,y as te,z as oe,A as _,G as N,v as T}from"./index-a7oZ5LST.js";const re={slot:"footer",class:"text-right"},me=K({__name:"index",setup(de){const I=b([]),{bool:k,toggle:i}=D(),c=Q({}),f=()=>{j(c).then(d=>{I.value=d.list||[]})},w=d=>{var o;r.value=J.cloneDeep(d),g(),(o=x.value)==null||o.resetFields()},$=d=>{oe.confirm("确定删除吗？","提示",{type:"warning"}).then(()=>{i(),z(d).then(()=>{_.success("删除成功~"),f()}).finally(()=>i())}).catch(()=>{_.info("取消操作~")})},{bool:E,toggle:g}=D(),r=b({}),x=b(),M=()=>{var d;(d=x.value)==null||d.validate(o=>{o&&(r.value.id?P(r.value):R(r.value))})},P=d=>{i(),G(d).then(()=>{_.success("更新成功~"),g(),f()}).finally(()=>i())},R=d=>{i(),H(d).then(()=>{_.success("创建成功~"),g(),f()}).finally(()=>i())},C=b([]),L=()=>{O().then(d=>{C.value=d.list||[]})};return W(()=>{f(),L()}),(d,o)=>{const S=Z("loading");return p(),y(h,null,[X((p(),y("div",null,[l(e(B),{inline:""},{default:t(()=>[l(e(u),{prop:"name"},{default:t(()=>[l(e(V),{modelValue:c.name,"onUpdate:modelValue":o[0]||(o[0]=a=>c.name=a),placeholder:"商品名",clearable:""},null,8,["modelValue"])]),_:1}),l(e(u),{prop:"categoryId"},{default:t(()=>[l(e(U),{modelValue:c.categoryId,"onUpdate:modelValue":o[1]||(o[1]=a=>c.categoryId=a),placeholder:"商品分类",clearable:"",style:{width:"120px"}},{default:t(()=>[(p(!0),y(h,null,q(C.value,a=>(p(),N(e(T),{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(e(u),null,{default:t(()=>[l(e(m),{type:"primary",onClick:f},{default:t(()=>[s("查询")]),_:1}),l(e(m),{type:"success",onClick:o[2]||(o[2]=a=>w({price:1}))},{default:t(()=>[s("新增")]),_:1})]),_:1})]),_:1}),l(e(ee),{data:I.value,border:""},{default:t(()=>[l(e(n),{prop:"name",label:"商品名称",align:"center"}),l(e(n),{prop:"code",label:"商品标识",align:"center"}),l(e(n),{prop:"price",label:"商品单价",align:"center"},{default:t(({row:a})=>[l(e(F),{type:"danger"},{default:t(()=>[s("￥"+A(a.price),1)]),_:2},1024)]),_:1}),l(e(n),{prop:"description",label:"描述",align:"center"}),l(e(n),{prop:"categoryId",label:"所属类别",align:"center"},{default:t(({row:a})=>[l(e(F),{type:"primary"},{default:t(()=>{var v;return[s(A((v=a.category)==null?void 0:v.name),1)]}),_:2},1024)]),_:1}),l(e(n),{prop:"sellCount",label:"商品销量",align:"center"}),l(e(n),{prop:"createdAt",label:"创建时间",align:"center"}),l(e(n),{prop:"updatedAt",label:"更新时间",align:"center"}),l(e(n),{prop:"action",label:"操作",align:"center","min-width":"120px"},{default:t(({row:a})=>[l(e(m),{type:"primary",link:"",onClick:v=>w(a)},{default:t(()=>[s("编辑")]),_:2},1032,["onClick"]),l(e(m),{type:"danger",link:"",onClick:v=>$(a.id)},{default:t(()=>[s("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])])),[[S,e(k)]]),l(e(te),{modelValue:e(E),"onUpdate:modelValue":o[8]||(o[8]=a=>Y(E)?E.value=a:null),title:r.value.id?"编辑商品":"添加商品",width:"30%"},{default:t(()=>[l(e(B),{ref_key:"formRef",ref:x,model:r.value,"label-position":"top"},{default:t(()=>[l(e(u),{prop:"name",label:"商品名",rules:[{required:!0,message:"请输入商品名"}]},{default:t(()=>[l(e(V),{modelValue:r.value.name,"onUpdate:modelValue":o[3]||(o[3]=a=>r.value.name=a),disabled:!!r.value.id,placeholder:"请输入商品名"},null,8,["modelValue","disabled"])]),_:1}),l(e(u),{prop:"code",label:"商品标识",rules:[{required:!0,message:"请输入商品标识"}]},{default:t(()=>[l(e(V),{modelValue:r.value.code,"onUpdate:modelValue":o[4]||(o[4]=a=>r.value.code=a),disabled:!!r.value.id,placeholder:"请输入商品标识"},null,8,["modelValue","disabled"])]),_:1}),l(e(u),{prop:"price",label:"商品单价",rules:[{required:!0,type:"number",message:"请输入商品单价"}]},{default:t(()=>[l(e(le),{modelValue:r.value.price,"onUpdate:modelValue":o[5]||(o[5]=a=>r.value.price=a),min:.01,max:999999,step:.01},null,8,["modelValue"])]),_:1}),l(e(u),{prop:"description",label:"描述",rules:[{required:!0,message:"请输入描述"}]},{default:t(()=>[l(e(V),{modelValue:r.value.description,"onUpdate:modelValue":o[6]||(o[6]=a=>r.value.description=a),placeholder:"请输入描述",type:"textarea",rows:3,maxlength:255,"show-word-limit":""},null,8,["modelValue"])]),_:1}),l(e(u),{prop:"categoryId",label:"所属类别",rules:[{required:!0,type:"number",message:"请选择所属类别"}]},{default:t(()=>[l(e(U),{modelValue:r.value.categoryId,"onUpdate:modelValue":o[7]||(o[7]=a=>r.value.categoryId=a),placeholder:"请选择所属类别"},{default:t(()=>[(p(!0),y(h,null,q(C.value,a=>(p(),N(e(T),{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),ae("div",re,[l(e(m),{loading:e(k),onClick:e(g)},{default:t(()=>[s("取 消")]),_:1},8,["loading","onClick"]),l(e(m),{loading:e(k),type:"primary",onClick:M},{default:t(()=>[s("确 定")]),_:1},8,["loading"])])]),_:1},8,["modelValue","title"])],64)}}});export{me as default};
