import{d as O,J as P,a as v,B as S,o as V,w as y,u as o,c as $,e as t,f as n,x as _,t as f,Q as z,P as F,z as x,A as d,C,g as R,h as q,n as c,l as u,q as I,R as J}from"./index-CS0l65Ue.js";import{f as L,_ as Q,d as U}from"./product-card.vue_vue_type_script_setup_true_lang-DZQFQlTc.js";import{c as j}from"./shopOrder-judJreVV.js";import{u as G}from"./index-DQH8EVtg.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";const K={class:"selection"},W={class:"info"},X={class:"price"},Y=O({__name:"index",setup(Z){const{bool:b,toggle:r}=G(),g=P(),h=v([]),w=F(),p=async()=>{const e=await L(g.id);h.value=e.list||[]},i=v([]),k=e=>{i.value=e},B=S(()=>i.value.reduce((e,a)=>{var l;return e+a.count*(((l=a.product)==null?void 0:l.price)||0)},0).toFixed(2)),E=e=>{x.confirm("是否移除该商品？","提示",{type:"warning"}).then(()=>{r(),U(e.id).then(()=>{d.success("移除成功~"),p()}).finally(()=>r())}).catch(()=>{d.info("取消操作~")})},T=e=>{var a;return(e.count*(((a=e.product)==null?void 0:a.price)||0)).toFixed(2)},A=()=>{x.confirm("确认创建订单，并打开支付窗口吗？","提示",{type:"warning"}).then(()=>{D()}).catch(()=>{d.info("已取消创建订单~")})},D=()=>{const e=i.value.map(a=>a.id);r(),j(e,g.id).then(a=>{d.success("创建订单成功，为您打开付款页面~"),p(),M(a.data)}).finally(()=>r())},M=e=>{w.push(`/c/pay?id=${e.id}`)};return V(()=>{p()}),(e,a)=>{const l=C("el-tag"),m=C("el-button"),N=R("loading");return y((q(),$("div",null,[t(o(I),{data:h.value,onSelectionChange:k},{default:n(()=>[t(o(c),{type:"selection",align:"center"}),t(o(c),{prop:"product",label:"商品详情"},{default:n(({row:s})=>[t(Q,{data:s.product,onlyshow:!0},null,8,["data"])]),_:1}),t(o(c),{prop:"createdAt",label:"加入购物车时间",align:"center"}),t(o(c),{prop:"count",label:"数量",align:"center",width:"100px"},{default:n(({row:s})=>[t(l,{type:"danger",effect:"dark"},{default:n(()=>[u(f(s.count),1)]),_:2},1024)]),_:1}),t(o(c),{porp:"total",label:"总价",align:"center"},{default:n(({row:s})=>[t(l,{type:"danger",effect:"dark"},{default:n(()=>[u("￥"+f(T(s)),1)]),_:2},1024)]),_:1}),t(o(c),{prop:"action",label:"操作",width:"80px",align:"center"},{default:n(({row:s})=>[t(m,{type:"danger",link:"",onClick:ee=>E(s)},{default:n(()=>[u("移除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),y(_("div",K,[_("div",W,[_("h1",X,"￥ "+f(B.value),1),t(m,{type:"danger",size:"large",icon:o(J),onClick:A},{default:n(()=>[u("提交订单")]),_:1},8,["icon"])])],512),[[z,i.value.length]])])),[[N,o(b)]])}}}),ce=H(Y,[["__scopeId","data-v-780a8b75"]]);export{ce as default};
