import{r as V,d as S,a as k,b as j,o as z,c as w,w as L,u as e,e as l,f as t,i as O,F as G,g as H,h as A,E as n,j as m,k as f,l as r,m as D,n as u,p as C,t as U,q as J,s as B,v,x as K,y as P,z as Q,A as b}from"./index-a7oZ5LST.js";import{u as F}from"./index-BJJCNVtC.js";import{l as W}from"./lodash-DseUsP9g.js";const X=i=>V({url:"/user/all",method:"get",params:{username:i}}),Y=i=>V({url:"/user/create",method:"post",data:{model:i}}),Z=i=>V({url:"/user/update",method:"post",data:{model:i}}),ee=i=>V({url:"/user/delete",method:"get",params:{id:i}}),le={slot:"footer",class:"text-right"},oe=S({__name:"index",setup(i){const x=k([]),{bool:y,toggle:p}=F(),_=j({}),g=()=>{X(_.username).then(d=>{x.value=d.list||[]})},q=d=>{var s;o.value=W.cloneDeep(d),c(),(s=h.value)==null||s.resetFields()},T=d=>{Q.confirm("确定删除吗？","提示",{type:"warning"}).then(()=>{p(),ee(d).then(()=>{b.success("删除成功~"),g()}).finally(()=>p())}).catch(()=>{b.info("取消操作~")})},{bool:E,toggle:c}=F(),o=k({}),h=k(),M=()=>{var d;(d=h.value)==null||d.validate(s=>{s&&(o.value.id?N(o.value):R(o.value))})},N=d=>{p(),Z(d).then(()=>{b.success("更新成功~"),c(),g()}).finally(()=>p())},R=d=>{p(),Y(d).then(()=>{b.success("创建成功~"),c(),g()}).finally(()=>p())};return z(()=>{g()}),(d,s)=>{const $=H("loading");return A(),w(G,null,[L((A(),w("div",null,[l(e(D),{inline:""},{default:t(()=>[l(e(n),{prop:"username"},{default:t(()=>[l(e(m),{modelValue:_.username,"onUpdate:modelValue":s[0]||(s[0]=a=>_.username=a),placeholder:"用户名",clearable:""},null,8,["modelValue"])]),_:1}),l(e(n),null,{default:t(()=>[l(e(f),{type:"primary",onClick:g},{default:t(()=>[r("查询")]),_:1}),l(e(f),{type:"success",onClick:s[1]||(s[1]=a=>q({}))},{default:t(()=>[r("新增")]),_:1})]),_:1})]),_:1}),l(e(J),{data:x.value,border:""},{default:t(()=>[l(e(u),{prop:"username",label:"用户名",align:"center"}),l(e(u),{prop:"password",label:"密码",align:"center"},{default:t(()=>[r("******")]),_:1}),l(e(u),{prop:"phone",label:"手机号",align:"center"}),l(e(u),{prop:"email",label:"邮箱",align:"center"}),l(e(u),{prop:"address",label:"住址",align:"center"}),l(e(u),{prop:"gender",label:"性别",align:"center"},{default:t(({row:a})=>[l(e(C),{type:a.gender===1?"primary":"danger"},{default:t(()=>[r(U(a.gender===1?"男":"女"),1)]),_:2},1032,["type"])]),_:1}),l(e(u),{prop:"status",label:"状态",align:"center"},{default:t(({row:a})=>[l(e(C),{type:a.status===1?"success":"danger"},{default:t(()=>[r(U(a.status===1?"正常":"禁用"),1)]),_:2},1032,["type"])]),_:1}),l(e(u),{prop:"isAdmin",label:"管理员",align:"center"},{default:t(({row:a})=>[l(e(C),{type:a.isAdmin===1?"success":"danger"},{default:t(()=>[r(U(a.isAdmin===1?"是":"否"),1)]),_:2},1032,["type"])]),_:1}),l(e(u),{prop:"createdAt",label:"创建时间",align:"center"}),l(e(u),{prop:"updatedAt",label:"更新时间",align:"center"}),l(e(u),{prop:"action",label:"操作",align:"center","min-width":"120px"},{default:t(({row:a})=>[l(e(f),{type:"primary",link:"",onClick:I=>q(a)},{default:t(()=>[r("编辑")]),_:2},1032,["onClick"]),l(e(f),{type:"danger",link:"",onClick:I=>T(a.id)},{default:t(()=>[r("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])])),[[$,e(y)]]),l(e(P),{modelValue:e(E),"onUpdate:modelValue":s[9]||(s[9]=a=>O(E)?E.value=a:null),title:o.value.id?"编辑用户":"添加用户",width:"30%"},{default:t(()=>[l(e(D),{ref_key:"formRef",ref:h,model:o.value,"label-position":"top"},{default:t(()=>[l(e(n),{prop:"username",label:"用户名",rules:[{required:!0,message:"请输入用户名"}]},{default:t(()=>[l(e(m),{modelValue:o.value.username,"onUpdate:modelValue":s[2]||(s[2]=a=>o.value.username=a),disabled:!!o.value.id,placeholder:"请输入用户名"},null,8,["modelValue","disabled"])]),_:1}),l(e(n),{prop:"password",label:"密码",rules:[{required:!0,message:"请输入密码"}]},{default:t(()=>[l(e(m),{modelValue:o.value.password,"onUpdate:modelValue":s[3]||(s[3]=a=>o.value.password=a),type:"password",disabled:!!o.value.id,placeholder:"请输入密码"},null,8,["modelValue","disabled"])]),_:1}),l(e(n),{prop:"phone",label:"手机号",rules:[{required:!0,message:"请输入手机号"}]},{default:t(()=>[l(e(m),{modelValue:o.value.phone,"onUpdate:modelValue":s[4]||(s[4]=a=>o.value.phone=a),placeholder:"请输入手机号",maxlength:11},null,8,["modelValue"])]),_:1}),l(e(n),{prop:"email",label:"邮箱",rules:[{required:!0,type:"email",message:"请输入邮箱"}]},{default:t(()=>[l(e(m),{modelValue:o.value.email,"onUpdate:modelValue":s[5]||(s[5]=a=>o.value.email=a),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),l(e(n),{prop:"gender",label:"性别",rules:[{required:!0,type:"number",message:"请选择性别"}]},{default:t(()=>[l(e(B),{modelValue:o.value.gender,"onUpdate:modelValue":s[6]||(s[6]=a=>o.value.gender=a),placeholder:"请选择性别"},{default:t(()=>[l(e(v),{label:"男",value:1}),l(e(v),{label:"女",value:0})]),_:1},8,["modelValue"])]),_:1}),l(e(n),{prop:"address",label:"住址"},{default:t(()=>[l(e(m),{modelValue:o.value.address,"onUpdate:modelValue":s[7]||(s[7]=a=>o.value.address=a),placeholder:"请输入住址"},null,8,["modelValue"])]),_:1}),l(e(n),{prop:"status",label:"状态"},{default:t(()=>[l(e(B),{modelValue:o.value.status,"onUpdate:modelValue":s[8]||(s[8]=a=>o.value.status=a),placeholder:"请选择状态"},{default:t(()=>[l(e(v),{label:"正常",value:1}),l(e(v),{label:"禁用",value:0})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),K("div",le,[l(e(f),{loading:e(y),onClick:e(c)},{default:t(()=>[r("取 消")]),_:1},8,["loading","onClick"]),l(e(f),{loading:e(y),type:"primary",onClick:M},{default:t(()=>[r("确 定")]),_:1},8,["loading"])])]),_:1},8,["modelValue","title"])],64)}}});export{oe as default};
